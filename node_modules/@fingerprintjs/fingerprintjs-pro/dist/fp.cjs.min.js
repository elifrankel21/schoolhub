/**
 * FingerprintJS Pro v3.8.1 - Copyright (c) FingerprintJS, Inc, 2022 (https://fingerprint.com)
 *
 * This software contains code from open-source projects:
 * MurmurHash3 by Karan Lyons (https://github.com/karanlyons/murmurHash3.js)
 */

"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("tslib");function t(e,t){return function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(e,t)?e[t]:void 0}function r(e){for(var t="",r=0;r<e.length;++r)if(r>0){var n=e[r].toLowerCase();n!==e[r]?t+=" "+n:t+=e[r]}else t+=e[r].toUpperCase();return t}var n={default:"endpoint"},o={default:"tlsEndpoint"},R=r("WrongRegion"),i=r("SubscriptionNotActive"),E=r("UnsupportedVersion"),u=r("InstallationMethodRestricted"),a=r("HostnameRestricted"),s=r("IntegrationFailed");function _(t,r){var n=[];return function(t,r){var n=5,o=(s=t,_=e.__spreadArrays(s),{current:function(){return _[0]},postpone:function(){var e=_.shift();void 0!==e&&_.push(e)},exclude:function(){_.shift()}}),R=(E=100,u=3e3,a=0,function(){return Math.random()*Math.min(u,E*Math.pow(2,a++))}),i=o.current();var E,u,a;var s,_;if(void 0===i)return Promise.reject(new TypeError("The list of script URL patterns is empty"));var O=function(e,t){return r(e).catch((function(e){if(t+1>=n)throw e;!function(e){if(!(e instanceof Error))return!1;var t=e.message;return"Blocked by CSP"===t||"9319"===t}(e)?o.postpone():o.exclude();var r,i=o.current();if(void 0===i)throw e;return(r=R(),new Promise((function(e){return setTimeout(e,r)}))).then((function(){return O(i,t+1)}))}))};return O(i,0)}(t,(function(e){var t=new Date,o=function(){return n.push({url:e,startedAt:t,finishedAt:new Date})},R=r(e);return R.then(o,o),R})).then((function(e){return[e,{attempts:n}]}))}var O="https://fpnpmcdn.net/v<version>/<apiKey>/loader_v<loaderVersion>.js",c=O,d="Failed to load the JS script of the agent";function p(r){var n;r.scriptUrlPattern;var o=r.token,R=r.apiKey,i=void 0===R?o:R,E=e.__rest(r,["scriptUrlPattern","token","apiKey"]),u=null!==(n=t(r,"scriptUrlPattern"))&&void 0!==n?n:O;return Promise.resolve().then((function(){if(!i||"string"!=typeof i)throw new Error("API key required");return _(function(e,t){return(Array.isArray(e)?e:[e]).map((function(e){return function(e,t){var r=encodeURIComponent;return e.replace(/<[^<>]+>/g,(function(e){return"<version>"===e?"3":"<apiKey>"===e?r(t):"<loaderVersion>"===e?r("3.8.1"):e}))}(String(e),t)}))}(u,i),I).catch(f)})).then((function(t){var r=t[0],n=t[1];return r.load(e.__assign(e.__assign({},E),{ldi:n}))}))}function I(e){return function(e,t,r,n){var o,R=document,i="securitypolicyviolation",E=function(t){var r=new URL(e,location.href),n=t.blockedURI;n!==r.href&&n!==r.protocol.slice(0,-1)&&n!==r.origin||(o=t,u())};R.addEventListener(i,E);var u=function(){return R.removeEventListener(i,E)};return null==n||n.then(u,u),Promise.resolve().then(t).then((function(e){return u(),e}),(function(e){return new Promise((function(e){return setTimeout(e)})).then((function(){if(u(),o)return r(o);throw e}))}))}(e,(function(){return function(e){return new Promise((function(t,r){var n=document.createElement("script"),o=function(){var e;return null===(e=n.parentNode)||void 0===e?void 0:e.removeChild(n)},R=document.head||document.getElementsByTagName("head")[0];n.onload=function(){o(),t()},n.onerror=function(){o(),r(new Error(d))},n.async=!0,n.src=e,R.appendChild(n)}))}(e)}),(function(){throw new Error("Blocked by CSP")})).then(l)}function l(){var e=window,t="__fpjs_p_l_b",r=e[t];if(function(e,t){var r,n=null===(r=Object.getOwnPropertyDescriptor)||void 0===r?void 0:r.call(Object,e,t);(null==n?void 0:n.configurable)?delete e[t]:n&&!n.writable||(e[t]=void 0)}(e,t),"function"!=typeof(null==r?void 0:r.load))throw new Error("9319");return r}function f(e){throw e instanceof Error&&"9319"===e.message?new Error(d):e}var N={load:p,defaultScriptUrlPattern:c,ERROR_SCRIPT_LOAD_FAIL:d,ERROR_API_KEY_EXPIRED:"API key expired",ERROR_API_KEY_INVALID:"API key not found",ERROR_API_KEY_MISSING:"API key required",ERROR_BAD_REQUEST_FORMAT:"Request cannot be parsed",ERROR_BAD_RESPONSE_FORMAT:"Response cannot be parsed",ERROR_CLIENT_TIMEOUT:"Client timeout",ERROR_CSP_BLOCK:"Blocked by CSP",ERROR_FORBIDDEN_ENDPOINT:a,ERROR_FORBIDDEN_HEADER:"Not available with restricted header",ERROR_FORBIDDEN_ORIGIN:"Not available for this origin",ERROR_GENERAL_SERVER_FAILURE:"Request failed",ERROR_INSTALLATION_METHOD_RESTRICTED:u,ERROR_INTEGRATION_FAILURE:s,ERROR_NETWORK_ABORT:"Network request aborted",ERROR_NETWORK_CONNECTION:"Network connection error",ERROR_RATE_LIMIT:"Too many requests, rate limit exceeded",ERROR_SERVER_TIMEOUT:"Request failed to process",ERROR_SUBSCRIPTION_NOT_ACTIVE:i,ERROR_TOKEN_EXPIRED:"API key expired",ERROR_TOKEN_INVALID:"API key not found",ERROR_TOKEN_MISSING:"API key required",ERROR_UNSUPPORTED_VERSION:E,ERROR_WRONG_REGION:R,defaultEndpoint:n,defaultTlsEndpoint:o};exports.ERROR_API_KEY_EXPIRED="API key expired",exports.ERROR_API_KEY_INVALID="API key not found",exports.ERROR_API_KEY_MISSING="API key required",exports.ERROR_BAD_REQUEST_FORMAT="Request cannot be parsed",exports.ERROR_BAD_RESPONSE_FORMAT="Response cannot be parsed",exports.ERROR_CLIENT_TIMEOUT="Client timeout",exports.ERROR_CSP_BLOCK="Blocked by CSP",exports.ERROR_FORBIDDEN_ENDPOINT=a,exports.ERROR_FORBIDDEN_HEADER="Not available with restricted header",exports.ERROR_FORBIDDEN_ORIGIN="Not available for this origin",exports.ERROR_GENERAL_SERVER_FAILURE="Request failed",exports.ERROR_INSTALLATION_METHOD_RESTRICTED=u,exports.ERROR_INTEGRATION_FAILURE=s,exports.ERROR_NETWORK_ABORT="Network request aborted",exports.ERROR_NETWORK_CONNECTION="Network connection error",exports.ERROR_RATE_LIMIT="Too many requests, rate limit exceeded",exports.ERROR_SCRIPT_LOAD_FAIL=d,exports.ERROR_SERVER_TIMEOUT="Request failed to process",exports.ERROR_SUBSCRIPTION_NOT_ACTIVE=i,exports.ERROR_TOKEN_EXPIRED="API key expired",exports.ERROR_TOKEN_INVALID="API key not found",exports.ERROR_TOKEN_MISSING="API key required",exports.ERROR_UNSUPPORTED_VERSION=E,exports.ERROR_WRONG_REGION=R,exports.default=N,exports.defaultEndpoint=n,exports.defaultScriptUrlPattern=c,exports.defaultTlsEndpoint=o,exports.load=p;
